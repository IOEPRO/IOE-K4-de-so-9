
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOE L·ªöP 4 - ƒê·ªÄ S·ªê 09 (200 C√ÇU)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
      :root {
        --primary: #4f46e5;
        --secondary: #10b981;
        --danger: #ef4444;
        --warning: #f59e0b;
      }
      body { 
        font-family: 'Plus Jakarta Sans', sans-serif; 
        background-color: #f8fafc; 
        margin: 0;
        overflow-x: hidden;
      }
      .font-nunito { font-family: 'Nunito', sans-serif; }
      .custom-scrollbar::-webkit-scrollbar { width: 6px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
      @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
      }
      .animate-float { animation: float 3s ease-in-out infinite; }
      .glass {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      .btn-pop { transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
      .btn-pop:active { transform: scale(0.94); }
      .question-card-enter { animation: slideIn 0.5s cubic-bezier(0.23, 1, 0.32, 1) forwards; }
      @keyframes slideIn {
        from { opacity: 0; transform: translateY(30px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="antialiased">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef, useMemo } = React;

      const TOTAL_TIME = 60 * 60; // 60 ph√∫t
      const POINTS_PER_CORRECT = 10;

      const QuestionType = {
        MULTIPLE_CHOICE: 'MC',
        FILL_IN_BLANK: 'FIB',
        REARRANGE: 'RE'
      };

      const GameState = { START: 'START', PLAYING: 'PLAYING', FINISHED: 'FINISHED' };

      // H√ÄM CHU·∫®N H√ìA CHU·ªñI ƒê·ªÇ SO S√ÅNH CH√çNH X√ÅC (Fix l·ªói ch·∫•m ƒëi·ªÉm)
      const normalize = (s) => s ? s.toString().replace(/[.,!?;:'"]/g, '').replace(/\s+/g, ' ').trim().toLowerCase() : "";

      const RAW_QUESTIONS = [
        { id: 1, type: QuestionType.FILL_IN_BLANK, text: "___ John at home yesterday?", answer: "Was", exp: "Was + S (s·ªë √≠t) ·ªü qu√° kh·ª©.", hint: "To Be qu√° kh·ª©." },
        { id: 2, type: QuestionType.REARRANGE, parts: ["you", "like", "do", "doing?", "What"], answer: "What do you like doing?", exp: "H·ªèi v·ªÅ s·ªü th√≠ch.", hint: "What do you..." },
        { id: 3, type: QuestionType.REARRANGE, parts: ["read", "a", "book?", "she", "Can"], answer: "Can she read a book?", exp: "C√¢u h·ªèi kh·∫£ nƒÉng.", hint: "Can she..." },
        { id: 4, type: QuestionType.FILL_IN_BLANK, text: "She has three ______ on her desk.", img: "https://images.unsplash.com/photo-1550985543-49bee3167284?w=400", answer: "rulers", exp: "Three n√™n d√πng rulers (s·ªë nhi·ªÅu).", hint: "Th∆∞·ªõc k·∫ª." },
        { id: 5, type: QuestionType.MULTIPLE_CHOICE, text: "Can Nam play table tennis? ‚Äì Yes, he ___.", options: ["can", "can‚Äôt", "canot", "cannot"], answer: "can", exp: "Yes, S + can.", hint: "D·∫°ng kh·∫≥ng ƒë·ªãnh." },
        { id: 6, type: QuestionType.MULTIPLE_CHOICE, text: "She is ... Japan.", options: ["down", "up", "from", "under"], answer: "from", exp: "Be from: ƒë·∫øn t·ª´.", hint: "Qu√™ qu√°n." },
        { id: 7, type: QuestionType.MULTIPLE_CHOICE, text: "What subjects do you ___ ? ‚Äì I don‚Äôt like Maths and Art.", options: ["dislike", "like", "don‚Äôt like", "love"], answer: "like", exp: "Do you like: b·∫°n c√≥ th√≠ch.", hint: "S·ªü th√≠ch." },
        { id: 8, type: QuestionType.MULTIPLE_CHOICE, text: "Peter can ‚Ä¶ a bike.", options: ["ride", "play", "stay", "drink"], answer: "ride", exp: "Ride a bike: ƒëi xe ƒë·∫°p.", hint: "L√°i xe ƒë·∫°p." },
        { id: 9, type: QuestionType.FILL_IN_BLANK, text: "S_ ORT", answer: "P", exp: "Sport: th·ªÉ thao.", hint: "Ch·ªØ c√°i thi·∫øu." },
        { id: 10, type: QuestionType.FILL_IN_BLANK, text: "A: Good n_ _ _ _ , Mom. - B: Have a good sleep, my son.", answer: "night", exp: "Good night: ch√∫c ng·ªß ngon.", hint: "Bu·ªïi ƒë√™m." },
        { id: 11, type: QuestionType.REARRANGE, parts: ["to", "Jenny.", "Happy", "birthday", "you,"], answer: "Happy birthday to you, Jenny.", exp: "L·ªùi ch√∫c sinh nh·∫≠t.", hint: "Happy birthday..." },
        { id: 12, type: QuestionType.FILL_IN_BLANK, text: "FRIE_ D", answer: "N", exp: "Friend: ng∆∞·ªùi b·∫°n.", hint: "B·∫°n b√®." },
        { id: 13, type: QuestionType.FILL_IN_BLANK, text: "What is your h_ _ _ y? ‚Äì I like drawing.", answer: "hobby", exp: "Hobby: s·ªü th√≠ch.", hint: "S·ªü th√≠ch." },
        { id: 14, type: QuestionType.REARRANGE, parts: ["party.", "This", "is", "my birthday"], answer: "This is my birthday party.", exp: "B·ªØa ti·ªác c·ªßa t√¥i.", hint: "This is..." },
        { id: 15, type: QuestionType.REARRANGE, parts: ["I‚Äôm", "well,", "too.", "very"], answer: "I‚Äôm very well, too.", exp: "T·ªõ c≈©ng kh·ªèe.", hint: "I'm very..." },
        { id: 16, type: QuestionType.FILL_IN_BLANK, text: "All the water in the oceans and _ _ _ _ is salt water.", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790887695176741_Audio.mp3", answer: "sea", exp: "Sea: bi·ªÉn.", hint: "Bi·ªÉn." },
        { id: 17, type: QuestionType.FILL_IN_BLANK, text: "Where _ _ _ the dolls?", answer: "are", exp: "Dolls l√† s·ªë nhi·ªÅu.", hint: "To Be s·ªë nhi·ªÅu." },
        { id: 18, type: QuestionType.FILL_IN_BLANK, text: "He is from _________ .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206402675416532_Audio.mp3", answer: "Singapore", exp: "Qu·ªëc gia: Singapore.", hint: "B·∫Øt ƒë·∫ßu b·∫±ng S." },
        { id: 19, type: QuestionType.FILL_IN_BLANK, text: "Please _ _ _ _ me some more sugar.", answer: "give", exp: "Give me: cho t√¥i.", hint: "Cho/ƒë∆∞a." },
        { id: 20, type: QuestionType.MULTIPLE_CHOICE, text: "Mary and Linda are ... .", img: "https://images.unsplash.com/photo-1574348996587-27da2f36ec46?w=400", options: ["painting pictures", "making puppets", "making boats", "painting masks"], answer: "making puppets", exp: "L√†m con r·ªëi.", hint: "Puppets." },
        { id: 21, type: QuestionType.MULTIPLE_CHOICE, text: "Are the books on the table? ‚Äì Yes, they ... .", options: ["am", "is", "are", "to"], answer: "are", exp: "Yes, they are.", hint: "H·ªèi are tr·∫£ l·ªùi are." },
        { id: 22, type: QuestionType.MULTIPLE_CHOICE, text: "Let‚Äôs draw a picture of a ... .", img: "https://images.unsplash.com/photo-1719027103866-feacf3a4f679?w=400", options: ["dog", "fish", "cat", "Monkey"], answer: "Monkey", exp: "Con kh·ªâ.", hint: "Kh·ªâ." },
        { id: 23, type: QuestionType.REARRANGE, parts: ["please.", "your", "book,", "Open"], answer: "Open your book, please.", exp: "M·ªü s√°ch ra.", hint: "Open..." },
        { id: 24, type: QuestionType.FILL_IN_BLANK, text: "Her father raises cows, sheep and _ _ _ _ _ on his farm.", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636161990907660300_Audio.mp3", answer: "goats", exp: "Goats: nh·ªØng con d√™.", hint: "Con d√™." },
        { id: 25, type: QuestionType.FILL_IN_BLANK, text: "Is he strong or _ _ _ _ ?", answer: "weak", exp: "Weak: y·∫øu (tr√°i nghƒ©a strong).", hint: "Y·∫øu." },
        { id: 26, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["chair", "monkey", "rabbit", "fish"], answer: "chair", exp: "ƒê·ªì v·∫≠t, c√≤n l·∫°i l√† con v·∫≠t.", hint: "Kh√°c lo·∫°i." },
        { id: 27, type: QuestionType.FILL_IN_BLANK, text: "Everyday, I _ _ _ up early.", answer: "get", exp: "Get up: th·ª©c d·∫≠y.", hint: "Th·ª©c d·∫≠y." },
        { id: 28, type: QuestionType.FILL_IN_BLANK, text: "_ _ _ are you? - I‚Äôm fine, thanks.", answer: "How", exp: "How are you?", hint: "H·ªèi s·ª©c kh·ªèe." },
        { id: 29, type: QuestionType.FILL_IN_BLANK, text: "I wa_ born in October.", answer: "s", exp: "Was born.", hint: "Thi·∫øu s." },
        { id: 30, type: QuestionType.REARRANGE, parts: ["playing", "I like", "football", "in", "the rain."], answer: "I like playing football in the rain.", exp: "Th√≠ch b√≥ng ƒë√° d∆∞·ªõi m∆∞a.", hint: "I like..." },
        { id: 31, type: QuestionType.MULTIPLE_CHOICE, text: "What _______ does Anh have? ‚Äì She has three yo-yos.", options: ["books", "pens", "pets", "toys"], answer: "toys", exp: "Yo-yos l√† ƒë·ªì ch∆°i.", hint: "ƒê·ªì ch∆°i." },
        { id: 32, type: QuestionType.MULTIPLE_CHOICE, text: "Where is Mary from? ‚Äì ...", options: ["She‚Äôs from England.", "She from England.", "She does England.", "England from"], answer: "She‚Äôs from England.", exp: "ƒê·∫øn t·ª´ Anh.", hint: "ƒê·∫ßy ƒë·ªß To Be." },
        { id: 33, type: QuestionType.REARRANGE, parts: ["My dad", "short", "but", "is", "handsome."], answer: "My dad is short but handsome.", exp: "M√¥ t·∫£ ng∆∞·ªùi.", hint: "My dad..." },
        { id: 34, type: QuestionType.REARRANGE, parts: ["I have", "the week.", "of", "Maths", "every day"], answer: "I have Maths every day of the week.", exp: "L·ªãch h·ªçc to√°n.", hint: "I have..." },
        { id: 35, type: QuestionType.FILL_IN_BLANK, text: "Their town is _ _ _ _ _ .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636162028476800629_Audio.mp3", answer: "small", exp: "Small: nh·ªè.", hint: "Nh·ªè." },
        { id: 36, type: QuestionType.MULTIPLE_CHOICE, text: "Choose the word that has different pronunciation", options: ["Zoo", "School", "Book", "Food"], answer: "Book", exp: "Book / ä/, c√°c t·ª´ kh√°c /uÀê/.", hint: "Ph√°t √¢m oo." },
        { id: 37, type: QuestionType.REARRANGE, parts: ["is", "a student", "Oxford Primary School.", "Mary", "at"], answer: "Mary is a student at Oxford Primary School.", exp: "ƒê·ªãa ƒëi·ªÉm h·ªçc t·∫≠p.", hint: "Mary is..." },
        { id: 38, type: QuestionType.FILL_IN_BLANK, text: "Thank you very m_ _ h.", answer: "much", exp: "Very much.", hint: "Nhi·ªÅu." },
        { id: 39, type: QuestionType.FILL_IN_BLANK, text: "Her _ _ _ _ _ _ _ _ _ food is ice-cream.", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636161990316877921_Audio.mp3", answer: "favourite", exp: "Favourite: y√™u th√≠ch.", hint: "Y√™u th√≠ch." },
        { id: 40, type: QuestionType.FILL_IN_BLANK, text: "Write the sent_ _ ces.", answer: "en", exp: "Sentences: c√°c c√¢u.", hint: "Thi·∫øu en." },
        { id: 41, type: QuestionType.FILL_IN_BLANK, text: "CH_ _ KEN", answer: "IC", exp: "Chicken: con g√†.", hint: "Con g√†." },
        { id: 42, type: QuestionType.MULTIPLE_CHOICE, text: "My grandparents ___ to the radio.", options: ["listening", "are listening", "is listening", "listen"], answer: "listen", exp: "Th√≥i quen hi·ªán t·∫°i.", hint: "H√†nh ƒë·ªông th∆∞·ªùng xuy√™n." },
        { id: 43, type: QuestionType.MULTIPLE_CHOICE, text: "What ... is this? ‚Äì It‚Äôs blue.", options: ["colour", "name", "nice", "hi"], answer: "colour", exp: "Blue l√† m√†u s·∫Øc.", hint: "M√†u s·∫Øc." },
        { id: 44, type: QuestionType.REARRANGE, parts: ["is", "sunny", "The", "today.", "weather"], answer: "The weather is sunny today.", exp: "Th·ªùi ti·∫øt h√¥m nay.", hint: "The weather..." },
        { id: 45, type: QuestionType.MULTIPLE_CHOICE, text: "Choose the odd one:", options: ["write", "sing", "read", "friend"], answer: "friend", exp: "Danh t·ª´, c√°c t·ª´ kh√°c l√† ƒë·ªông t·ª´.", hint: "Kh√°c lo·∫°i." },
        { id: 46, type: QuestionType.MULTIPLE_CHOICE, text: "‚Ä¶ is your birthday? - It‚Äôs in July.", options: ["What", "How", "When", "Where"], answer: "When", exp: "Khi n√†o.", hint: "Th·ªùi gian." },
        { id: 47, type: QuestionType.FILL_IN_BLANK, text: "Tom‚Äôs from _ _ _ _ _ _ _ .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/29/636790679070814804_Audio.mp3", answer: "America", exp: "N∆∞·ªõc M·ªπ.", hint: "M·ªπ." },
        { id: 48, type: QuestionType.REARRANGE, parts: ["bed.", "The toys", "the", "on", "are"], answer: "The toys are on the bed.", exp: "ƒê·ªì ch∆°i tr√™n gi∆∞·ªùng.", hint: "The toys..." },
        { id: 49, type: QuestionType.REARRANGE, parts: ["badminton", "likes", "Her mother", "very much.", "playing"], answer: "Her mother likes playing badminton very much.", exp: "S·ªü th√≠ch c·∫ßu l√¥ng.", hint: "Her mother..." },
        { id: 50, type: QuestionType.MULTIPLE_CHOICE, text: "Listen and tick:", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206438387382635_Audio.mp3", options: ["My house is very small.", "My school is very big.", "My school is very small.", "My house is very big."], answer: "My house is very big.", exp: "Nghe n·ªôi dung nh√†.", hint: "Nh√† to." },
        { id: 51, type: QuestionType.FILL_IN_BLANK, text: "My bir_ _ day is in December.", answer: "th", exp: "Birthday.", hint: "Thi·∫øu th." },
        { id: 52, type: QuestionType.MULTIPLE_CHOICE, text: "Where are the keys?", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D1_7.mp3", options: ["They are on the table.", "They are under the car.", "They are in the car.", "They are in the living room."], answer: "They are under the car.", exp: "D∆∞·ªõi g·∫ßm xe.", hint: "D∆∞·ªõi." },
        { id: 53, type: QuestionType.MULTIPLE_CHOICE, text: "_____ is your birthday? ‚Äì It‚Äôs in March.", options: ["Where", "What", "When", "How"], answer: "When", exp: "H·ªèi khi n√†o.", hint: "Th·ªùi gian." },
        { id: 54, type: QuestionType.REARRANGE, parts: ["Last Sunday,", "I", "visited my", "grandpa", "in the country."], answer: "Last Sunday, I visited my grandpa in the country.", exp: "ThƒÉm √¥ng qu√™.", hint: "Last Sunday..." },
        { id: 55, type: QuestionType.REARRANGE, parts: ["you, Nga", "How are", "fine. Thank", "you?", "‚Äì I‚Äôm"], answer: "How are you, Nga? ‚Äì I‚Äôm fine. Thank you.", exp: "H·ªèi thƒÉm s·ª©c kh·ªèe.", hint: "How are..." },
        { id: 56, type: QuestionType.FILL_IN_BLANK, text: "A bee makes _ _ _ _ _ .", img: "https://images.unsplash.com/photo-1613548058193-1cd24c1bebcf?w=400", answer: "honey", exp: "M·∫≠t ong.", hint: "M·∫≠t ong." },
        { id: 57, type: QuestionType.FILL_IN_BLANK, text: "The pictures are on the _ all.", answer: "w", exp: "Wall: t∆∞·ªùng.", hint: "T∆∞·ªùng." },
        { id: 58, type: QuestionType.MULTIPLE_CHOICE, text: "Don‚Äôt write ‚Ä¶ the walls.", options: ["on", "at", "in", "to"], answer: "on", exp: "On the wall.", hint: "Tr√™n." },
        { id: 59, type: QuestionType.FILL_IN_BLANK, text: "L_ _ k at the picture.", answer: "oo", exp: "Look at.", hint: "Nh√¨n." },
        { id: 60, type: QuestionType.REARRANGE, parts: ["your best", "badminton, Mai?", "playing", "Do", "friends like"], answer: "Do your best friends like playing badminton, Mai?", exp: "C√¢u h·ªèi s·ªü th√≠ch b·∫°n b√®.", hint: "Do your best..." },
        { id: 61, type: QuestionType.FILL_IN_BLANK, text: "Let‚Äôs play _ _ _ _ _ _ _ _ _ after school.", answer: "badminton", exp: "Ch∆°i c·∫ßu l√¥ng.", hint: "C·∫ßu l√¥ng." },
        { id: 62, type: QuestionType.MULTIPLE_CHOICE, text: "They are ‚Ä¶ .", options: ["pencils", "sharpeners", "rulers", "erasers"], answer: "rulers", exp: "Th∆∞·ªõc k·∫ª.", hint: "Th∆∞·ªõc." },
        { id: 63, type: QuestionType.REARRANGE, parts: ["birthday", "is", "His", "May.", "in"], answer: "His birthday is in May.", exp: "Sinh nh·∫≠t anh ·∫•y.", hint: "His birthday..." },
        { id: 64, type: QuestionType.FILL_IN_BLANK, text: "I got some great photo_ _ _ _ _ s of the party.", answer: "graph", exp: "Photographs: nh·ªØng b·ª©c ·∫£nh.", hint: "·∫¢nh." },
        { id: 65, type: QuestionType.FILL_IN_BLANK, text: "My sister is a student at Hoang Mai Primary Sch_ _ _ .", answer: "ool", exp: "School.", hint: "Tr∆∞·ªùng h·ªçc." },
        { id: 66, type: QuestionType.FILL_IN_BLANK, text: "This is an invitat_ _ n card.", img: "https://plus.unsplash.com/premium_vector-1718305034409-0c8c0436ff63?w=400", answer: "io", exp: "Invitation card.", hint: "Thi·∫øu io." },
        { id: 67, type: QuestionType.MULTIPLE_CHOICE, text: "Listen and tick:", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206435918083072_Audio.mp3", options: ["Where is your school?", "When is her birthday?", "Where is her school?", "When is your birthday?"], answer: "When is your birthday?", exp: "Nghe sinh nh·∫≠t.", hint: "Khi n√†o sinh nh·∫≠t." },
        { id: 68, type: QuestionType.FILL_IN_BLANK, text: "_ _ _ often do you do morning exercises?", answer: "How", exp: "How often.", hint: "H·ªèi t·∫ßn su·∫•t." },
        { id: 69, type: QuestionType.FILL_IN_BLANK, text: "I ha_ _ English on Monday and Thursday.", answer: "ve", exp: "Have.", hint: "Thi·∫øu ve." },
        { id: 70, type: QuestionType.FILL_IN_BLANK, text: "Where is he f_ _ m? ‚Äì He is from England.", answer: "ro", exp: "From.", hint: "Thi·∫øu ro." },
        { id: 71, type: QuestionType.MULTIPLE_CHOICE, text: "What‚Äôs this? - It‚Äôs a ... .", img: "https://plus.unsplash.com/premium_vector-1727953894718-668694769e34?w=400", options: ["bottle of wine", "bottle of water", "glass of milk", "cup of coffee"], answer: "bottle of water", exp: "Chai n∆∞·ªõc.", hint: "N∆∞·ªõc ƒë√≥ng chai." },
        { id: 72, type: QuestionType.FILL_IN_BLANK, text: "He invites his friend into his _ _ _ _ .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2016/12/1/636162028019768369_Audio.mp3", answer: "flat", exp: "Flat: cƒÉn h·ªô.", hint: "CƒÉn h·ªô." },
        { id: 73, type: QuestionType.MULTIPLE_CHOICE, text: "Why ... we come and visit Uncle Tom?", options: ["don‚Äôt", "have", "do", "aren‚Äôt"], answer: "don‚Äôt", exp: "Why don't we...?", hint: "G·ª£i √Ω." },
        { id: 74, type: QuestionType.MULTIPLE_CHOICE, text: "A: Is your school small? B: ..., it is.", options: ["No", "Yes", "Bye", "See you."], answer: "Yes", exp: "B: Yes, it is.", hint: "ƒê·ªìng √Ω." },
        { id: 75, type: QuestionType.MULTIPLE_CHOICE, text: "My birthday is ... April.", options: ["on", "at", "to", "in"], answer: "in", exp: "In + th√°ng.", hint: "Th√°ng." },
        { id: 76, type: QuestionType.FILL_IN_BLANK, text: "There are two r_ _ _ _ _ .", img: "https://plus.unsplash.com/premium_vector-1722586231051-df3592b558d0?w=400", answer: "ulers", exp: "Rulers.", hint: "Th∆∞·ªõc." },
        { id: 77, type: QuestionType.FILL_IN_BLANK, text: " Brian is a good dr_ _ _ r.", img: "https://plus.unsplash.com/premium_vector-1755624387525-67470e462339?w=400", answer: "ive", exp: "Driver: t√†i x·∫ø.", hint: "T√†i x·∫ø." },
        { id: 78, type: QuestionType.REARRANGE, parts: ["to bed?", "do you", "time", "go", "What"], answer: "What time do you go to bed?", exp: "Gi·ªù ƒëi ng·ªß.", hint: "What time..." },
        { id: 79, type: QuestionType.MULTIPLE_CHOICE, text: "This birthday cake is ... you", options: ["for", "on", "of", "to"], answer: "for", exp: "For you: d√†nh cho b·∫°n.", hint: "D√†nh cho." },
        { id: 80, type: QuestionType.MULTIPLE_CHOICE, text: "... the weather today?", options: ["What‚Äôs", "Where‚Äôs", "How‚Äôs", "And"], answer: "How‚Äôs", exp: "How's the weather.", hint: "Th·ªùi ti·∫øt." },
        { id: 81, type: QuestionType.FILL_IN_BLANK, text: " Do you want to c_ _ _ _ with me?", img: "https://plus.unsplash.com/premium_vector-1722190648996-ab8e9a2d18b3?w=400", answer: "ycle", exp: "Cycle: ƒë·∫°p xe.", hint: "ƒê·∫°p xe." },
        { id: 82, type: QuestionType.MULTIPLE_CHOICE, text: " How many stickers?", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/Thi_cac_cap/2020-2021/Lop4/Captruong/nghe/D4_16.mp3", options: ["16", "60", "14", "40"], answer: "60", exp: "Nghe: sixty (60).", hint: "S√°u m∆∞∆°i." },
        { id: 83, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["read", "sing", "blue", "play"], answer: "blue", exp: "Blue l√† m√†u s·∫Øc.", hint: "Kh√°c lo·∫°i." },
        { id: 84, type: QuestionType.MULTIPLE_CHOICE, text: "‚Ä¶ do you like to eat? ‚Äì I like pizza.", options: ["Which", "What", "How", "Who"], answer: "What", exp: "C√°i g√¨.", hint: "H·ªèi v·∫≠t." },
        { id: 85, type: QuestionType.FILL_IN_BLANK, text: "I‚Äôm in _ _ _ _ _ 4A.", answer: "class", exp: "Class: l·ªõp.", hint: "L·ªõp h·ªçc." },
        { id: 86, type: QuestionType.FILL_IN_BLANK, text: "A: How‚Äôs the weat_ _ r today?", answer: "he", exp: "Weather.", hint: "Th·ªùi ti·∫øt." },
        { id: 87, type: QuestionType.MULTIPLE_CHOICE, text: "Before I go to bed, my mother says: ‚Äô‚Äô‚Ä¶, son.‚Äô‚Äô", options: ["Good morning", "Good night", "Good evening", "Good afternoon"], answer: "Good night", exp: "Ch√∫c ng·ªß ngon.", hint: "Bu·ªïi ƒë√™m." },
        { id: 88, type: QuestionType.FILL_IN_BLANK, text: "What _ _ _ _ does your family have breakfast?", answer: "time", exp: "What time.", hint: "Th·ªùi gian." },
        { id: 89, type: QuestionType.FILL_IN_BLANK, text: "She has three _ _ _ _ _ _ _ _ _ on her desk.", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206440611946543_Audio.mp3", answer: "notebooks", exp: "V·ªü ghi b√†i.", hint: "Notebooks." },
        { id: 90, type: QuestionType.FILL_IN_BLANK, text: "Tom can s_ _ _ k Vietnamese.", answer: "pea", exp: "Speak: n√≥i.", hint: "N√≥i." },
        { id: 91, type: QuestionType.REARRANGE, parts: ["my", "I love", "much.", "very", "mother"], answer: "I love my mother very much.", exp: "Y√™u m·∫π.", hint: "I love..." },
        { id: 92, type: QuestionType.REARRANGE, parts: ["volleyball.", "play", "Let‚Äôs"], answer: "Let‚Äôs play volleyball.", exp: "Ch∆°i b√≥ng chuy·ªÅn.", hint: "Let's..." },
        { id: 93, type: QuestionType.REARRANGE, parts: ["is", "of October.", "Today", "third", "the"], answer: "Today is the third of October.", exp: "Ng√†y th√°ng.", hint: "Today is..." },
        { id: 94, type: QuestionType.FILL_IN_BLANK, text: "She is ha_ _ y.", answer: "pp", exp: "Happy.", hint: "H·∫°nh ph√∫c." },
        { id: 95, type: QuestionType.MULTIPLE_CHOICE, text: "What ... do you go to school?", options: ["name", "time", "subjects", "many"], answer: "time", exp: "What time.", hint: "Gi·ªù." },
        { id: 96, type: QuestionType.FILL_IN_BLANK, text: "Simon f_ _ m?", answer: "ro", exp: "From.", hint: "ƒê·∫øn t·ª´." },
        { id: 97, type: QuestionType.FILL_IN_BLANK, text: "_ _ _ _ _ are many shopping centres.", answer: "There", exp: "There are.", hint: "C√≥." },
        { id: 98, type: QuestionType.FILL_IN_BLANK, text: "_ _ _ _ _ birthday, Tom!", answer: "Happy", exp: "Happy birthday.", hint: "Ch√∫c m·ª´ng." },
        { id: 99, type: QuestionType.REARRANGE, parts: ["your", "me about", "Tell", "hobby, please."], answer: "Tell me about your hobby, please.", exp: "S·ªü th√≠ch c·ªßa b·∫°n.", hint: "Tell me..." },
        { id: 100, type: QuestionType.REARRANGE, parts: ["have", "lessons", "do you", "on Monday?", "What"], answer: "What lessons do you have on Monday?", exp: "Ti·∫øt h·ªçc th·ª© Hai.", hint: "What lessons..." },
        { id: 101, type: QuestionType.REARRANGE, parts: ["teddy", "any", "Are there", "bears on", "the bookshelf?"], answer: "Are there any teddy bears on the bookshelf?", exp: "G·∫•u b√¥ng.", hint: "Are there..." },
        { id: 102, type: QuestionType.FILL_IN_BLANK, text: "He was bor_ in May.", answer: "n", exp: "Born.", hint: "Sinh ra." },
        { id: 103, type: QuestionType.FILL_IN_BLANK, text: "birthday is on the 19th of M_ _ .", answer: "ay", exp: "May: th√°ng 5.", hint: "Th√°ng 5." },
        { id: 104, type: QuestionType.FILL_IN_BLANK, text: "What colour is your plane?- It‚Äôs _ _ _ .", answer: "red", exp: "Red: m√†u ƒë·ªè.", hint: "M√†u ƒë·ªè." },
        { id: 105, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["thirsty", "hungry", "full", "say"], answer: "say", exp: "ƒê·ªông t·ª´.", hint: "Kh√°c lo·∫°i." },
        { id: 106, type: QuestionType.REARRANGE, parts: ["this afternoon?", "do", "What", "your father", "did"], answer: "What did your father do this afternoon?", exp: "B·ªë b·∫°n l√†m g√¨.", hint: "What did..." },
        { id: 107, type: QuestionType.REARRANGE, parts: ["birthday", "My", "is", "in", "June."], answer: "My birthday is in June.", exp: "Th√°ng 6.", hint: "My birthday..." },
        { id: 108, type: QuestionType.FILL_IN_BLANK, text: "We are having _ _ Art lesson.", answer: "an", exp: "An + nguy√™n √¢m.", hint: "M·∫°o t·ª´." },
        { id: 109, type: QuestionType.REARRANGE, parts: ["have", "any", "you", "toys?", "Do"], answer: "Do you have any toys?", exp: "C√≥ ƒë·ªì ch∆°i kh√¥ng.", hint: "Do you..." },
        { id: 110, type: QuestionType.FILL_IN_BLANK, text: "My brother can c_ _ _ very well.", img: "https://plus.unsplash.com/premium_vector-1722927847190-dfeb8f345be9?w=400", answer: "ook", exp: "Cook: n·∫•u ƒÉn.", hint: "N·∫•u ƒÉn." },
        { id: 111, type: QuestionType.MULTIPLE_CHOICE, text: "Mary has ... dolls.", options: ["a", "an", "two", "and"], answer: "two", exp: "Dolls s·ªë nhi·ªÅu.", hint: "S·ªë ƒë·∫øm." },
        { id: 112, type: QuestionType.MULTIPLE_CHOICE, text: "The gym _______ new.", options: ["it", "it‚Äôs", "is", "its"], answer: "is", exp: "To Be s·ªë √≠t.", hint: "Is." },
        { id: 113, type: QuestionType.FILL_IN_BLANK, text: "What _ _ _ _ _ is it? ‚Äì It‚Äôs October.", answer: "month", exp: "Month: th√°ng.", hint: "Th√°ng." },
        { id: 114, type: QuestionType.REARRANGE, parts: ["This", "banana", "you.", "for", "is"], answer: "This banana is for you.", exp: "Chu·ªëi cho b·∫°n.", hint: "This banana..." },
        { id: 115, type: QuestionType.FILL_IN_BLANK, text: "A: What‚Äôs your _ _ _ _ y? - B: I like taking photos.", answer: "hobby", exp: "S·ªü th√≠ch.", hint: "Hobby." },
        { id: 116, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["Big", "My", "Small", "Large"], answer: "My", exp: "My l√† ƒë·∫°i t·ª´.", hint: "Kh√°c lo·∫°i." },
        { id: 117, type: QuestionType.MULTIPLE_CHOICE, text: "Tim: ... is Tom from?", options: ["What", "When", "Where", "How"], answer: "Where", exp: "Where...from.", hint: "·ªû ƒë√¢u." },
        { id: 118, type: QuestionType.REARRANGE, parts: ["and I", "shopping.", "going", "like", "My mother"], answer: "My mother and I like going shopping.", exp: "M·∫π v√† t√¥i.", hint: "My mother..." },
        { id: 119, type: QuestionType.FILL_IN_BLANK, text: "Ha_ _ y birthday.", answer: "pp", exp: "Happy.", hint: "Vui v·∫ª." },
        { id: 120, type: QuestionType.MULTIPLE_CHOICE, text: "Is Mary a student? - Yes, ... .", options: ["she is", "she does", "she doesn‚Äôt", "she isn‚Äôt"], answer: "she is", exp: "Yes, S + be.", hint: "ƒê√∫ng." },
        { id: 121, type: QuestionType.MULTIPLE_CHOICE, text: "...does Lan have literature?", options: ["What", "When", "Where", "How many"], answer: "When", exp: "H·ªèi th·ªùi gian.", hint: "Khi n√†o." },
        { id: 122, type: QuestionType.FILL_IN_BLANK, text: "brother cann_ _ play.", answer: "ot", exp: "Cannot.", hint: "Kh√¥ng th·ªÉ." },
        { id: 123, type: QuestionType.MULTIPLE_CHOICE, text: "___ you Australian?", options: ["Am", "Do", "Are", "Is"], answer: "Are", exp: "Are you...?", hint: "To Be." },
        { id: 124, type: QuestionType.FILL_IN_BLANK, text: "classr_ _ m.", answer: "oo", exp: "Classroom.", hint: "L·ªõp h·ªçc." },
        { id: 125, type: QuestionType.MULTIPLE_CHOICE, text: "Listen and tick:", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206447604044824_Audio.mp3", options: ["There are three books under the table.", "There are three boats on the table.", "There are three books on the table.", "There are three boxes on the table."], answer: "There are three boats on the table.", exp: "Nghe con thuy·ªÅn.", hint: "Boats." },
        { id: 126, type: QuestionType.FILL_IN_BLANK, text: "What is the d_ _ _ today?", answer: "ate", exp: "Date: ng√†y.", hint: "Ng√†y." },
        { id: 127, type: QuestionType.REARRANGE, parts: ["an", "have", "We", "on Monday.", "English lesson"], answer: "We have an English lesson on Monday.", exp: "Ti·∫øt Ti·∫øng Anh.", hint: "We have..." },
        { id: 128, type: QuestionType.REARRANGE, parts: ["Mary", "skirt.", "a green", "has"], answer: "Mary has a green skirt.", exp: "V√°y xanh.", hint: "Mary has..." },
        { id: 129, type: QuestionType.REARRANGE, parts: ["your", "is", "sister's", "Where", "room?"], answer: "Where is your sister's room?", exp: "Ph√≤ng em g√°i.", hint: "Where is..." },
        { id: 130, type: QuestionType.FILL_IN_BLANK, text: "I‚Äôm so_ _ y.", answer: "rr", exp: "Sorry.", hint: "Xin l·ªói." },
        { id: 131, type: QuestionType.MULTIPLE_CHOICE, text: "This is my ... .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206417649947497_Audio.mp3", options: ["workbook", "notebook", "homework", "Books"], answer: "notebook", exp: "V·ªü ghi.", hint: "Notebook." },
        { id: 132, type: QuestionType.MULTIPLE_CHOICE, text: "‚Ä¶ to meet you.", options: ["Well", "Fine", "Nice", "Kind"], answer: "Nice", exp: "Nice to meet you.", hint: "R·∫•t vui." },
        { id: 133, type: QuestionType.FILL_IN_BLANK, text: "e_ _ _ _ _ _ _ .", img: "https://plus.unsplash.com/premium_vector-1730546789269-72f7471ced60?w=400", answer: "lephant", exp: "Elephant: con voi.", hint: "Voi." },
        { id: 134, type: QuestionType.MULTIPLE_CHOICE, text: "What subject do you like?", options: ["Cakes", "Maths", "Milk", "England"], answer: "Maths", exp: "Maths l√† m√¥n h·ªçc.", hint: "M√¥n h·ªçc." },
        { id: 135, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["cake", "kite", "doll", "school"], answer: "school", exp: "N∆°i ch·ªën.", hint: "Kh√°c lo·∫°i." },
        { id: 136, type: QuestionType.REARRANGE, parts: ["small?", "big", "or", "your classroom", "Is"], answer: "Is your classroom big or small?", exp: "H·ªèi k√≠ch th∆∞·ªõc.", hint: "Is your..." },
        { id: 137, type: QuestionType.FILL_IN_BLANK, text: "Today is S_ _ day. I don‚Äôt go to school.", answer: "un", exp: "Sunday: Ch·ªß nh·∫≠t.", hint: "Ch·ªß nh·∫≠t." },
        { id: 138, type: QuestionType.REARRANGE, parts: ["John", "likes to", "very much.", "play", "games"], answer: "John likes to play games very much.", exp: "John th√≠ch ch∆°i game.", hint: "John likes..." },
        { id: 139, type: QuestionType.MULTIPLE_CHOICE, text: "I don‚Äôt like numbers so I don't like ‚Ä¶ .", options: ["Maths", "Music", "Art", "English"], answer: "Maths", exp: "To√°n c√≥ s·ªë.", hint: "M√¥n to√°n." },
        { id: 140, type: QuestionType.FILL_IN_BLANK, text: "My father is helping me m_ _ _ a kite.", img: "https://media.istockphoto.com/id/538655414/vector/father-son-making-kite.webp?a=1&b=1&s=612x612&w=0&k=20&c=M7wwTQzjV8bAhvRN5BQmrZkKG-i8UYr5Smlv72Qa4Z8=", answer: "ake", exp: "Make a kite.", hint: "L√†m di·ªÅu." },
        { id: 141, type: QuestionType.MULTIPLE_CHOICE, text: "The picture is _______ the window.", options: ["next", "next to", "front", "in front"], answer: "next to", exp: "B√™n c·∫°nh.", hint: "V·ªã tr√≠." },
        { id: 142, type: QuestionType.REARRANGE, parts: ["My", "a", "is", "mother", "doctor."], answer: "My mother is a doctor.", exp: "M·∫π l√† b√°c sƒ©.", hint: "My mother..." },
        { id: 143, type: QuestionType.FILL_IN_BLANK, text: "brother p_ _ y football?", answer: "la", exp: "Play.", hint: "Ch∆°i." },
        { id: 144, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["Eight", "Second", "Six", "Seven"], answer: "Second", exp: "S·ªë th·ª© t·ª±.", hint: "S·ªë ƒë·∫øm." },
        { id: 145, type: QuestionType.REARRANGE, parts: ["do", "Why", "you", "football?", "like"], answer: "Why do you like football?", exp: "H·ªèi l√Ω do.", hint: "Why do you..." },
        { id: 146, type: QuestionType.MULTIPLE_CHOICE, text: "What‚Äôs the weather in winter?", options: ["It‚Äôs hot.", "It hot.", "It‚Äôs cold.", "It cold."], answer: "It‚Äôs cold.", exp: "M√πa ƒë√¥ng l·∫°nh.", hint: "L·∫°nh." },
        { id: 147, type: QuestionType.FILL_IN_BLANK, text: "The bedrooms _ _ _ small.", answer: "are", exp: "To Be s·ªë nhi·ªÅu.", hint: "Are." },
        { id: 148, type: QuestionType.REARRANGE, parts: ["is", "Quang Binh", "central", "Vietnam.", "in"], answer: "Quang Binh is in central Vietnam.", exp: "Mi·ªÅn trung VN.", hint: "Quang Binh..." },
        { id: 149, type: QuestionType.MULTIPLE_CHOICE, text: "... notebooks are there in your schoolbag?", options: ["How old", "What subjects", "How many", "Who‚Äôs"], answer: "How many", exp: "H·ªèi s·ªë l∆∞·ª£ng.", hint: "Bao nhi√™u." },
        { id: 150, type: QuestionType.MULTIPLE_CHOICE, text: "days in November.", options: ["thirty", "thirty one", "thirty first", "thirteen"], answer: "thirty", exp: "T11 c√≥ 30 ng√†y.", hint: "30." },
        { id: 151, type: QuestionType.REARRANGE, parts: ["going to", "are they", "travel", "next year?", "Where"], answer: "Where are they going to travel next year?", exp: "Du l·ªãch ƒë√¢u.", hint: "Where are..." },
        { id: 152, type: QuestionType.FILL_IN_BLANK, text: "This gift is _ _ _ you.", answer: "for", exp: "For you.", hint: "Cho." },
        { id: 153, type: QuestionType.FILL_IN_BLANK, text: "_ _ to school on Sunday.", answer: "go", exp: "Go.", hint: "ƒêi." },
        { id: 154, type: QuestionType.MULTIPLE_CHOICE, text: "Mary can ... a bicycle.", options: ["right", "ride", "rights", "rides"], answer: "ride", exp: "Ride a bicycle.", hint: "ƒêi xe." },
        { id: 155, type: QuestionType.MULTIPLE_CHOICE, text: "I am from America. I am ___.", options: ["America", "American", "England", "Americans"], answer: "American", exp: "Qu·ªëc t·ªãch M·ªπ.", hint: "Ng∆∞·ªùi M·ªπ." },
        { id: 156, type: QuestionType.MULTIPLE_CHOICE, text: "Playing the ___ is my hobby.", img: "https://plus.unsplash.com/premium_vector-1763412283136-8c3c8b22ab78?w=400", options: ["chess", "violin", "guitar", "Piano"], answer: "Piano", exp: "ƒê√†n Piano.", hint: "Piano." },
        { id: 157, type: QuestionType.REARRANGE, parts: ["school", "My", "big.", "is", "not"], answer: "My school is not big.", exp: "Tr∆∞·ªùng kh√¥ng to.", hint: "My school..." },
        { id: 158, type: QuestionType.MULTIPLE_CHOICE, text: "Helen is reading a ______. ", options: ["song", "cartoon", "picture", "book"], answer: "book", exp: "ƒê·ªçc s√°ch.", hint: "S√°ch." },
        { id: 159, type: QuestionType.FILL_IN_BLANK, text: "scho_ _ day.", answer: "ol", exp: "School.", hint: "Tr∆∞·ªùng." },
        { id: 160, type: QuestionType.FILL_IN_BLANK, text: "sm_ ll.", answer: "a", exp: "Small.", hint: "Nh·ªè." },
        { id: 161, type: QuestionType.REARRANGE, parts: ["TV.", "She‚Äôs reading", "comic", "books and", "he‚Äôs watching"], answer: "She‚Äôs reading comic books and he‚Äôs watching TV.", exp: "H√†nh ƒë·ªông song song.", hint: "She's reading..." },
        { id: 162, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["Japan", "Singapore", "French", "America"], answer: "French", exp: "Ng√¥n ng·ªØ.", hint: "Kh√°c lo·∫°i." },
        { id: 163, type: QuestionType.REARRANGE, parts: ["Would", "like", "some", "you", "milk?"], answer: "Would you like some milk?", exp: "L·ªùi m·ªùi.", hint: "Would you..." },
        { id: 164, type: QuestionType.MULTIPLE_CHOICE, text: "It‚Äôs not difficult ... a new dress.", options: ["make", "makes", "to make", "making"], answer: "to make", exp: "To V.", hint: "ƒê·ªÉ l√†m." },
        { id: 165, type: QuestionType.MULTIPLE_CHOICE, text: "It‚Äôs rainy ... September.", options: ["on", "to", "in", "up"], answer: "in", exp: "In + th√°ng.", hint: "Trong." },
        { id: 166, type: QuestionType.FILL_IN_BLANK, text: "Mal_ _ sian.", img: "https://media.istockphoto.com/id/1621903447/vector/flag-of-malaysia.webp?a=1&b=1&s=612x612&w=0&k=20&c=wE3vtATQHMNKSJFp2eQ2Z9qEwn3bUamXGmXUJJ71LMw=", answer: "ay", exp: "Malaysian.", hint: "M√£ Lai." },
        { id: 167, type: QuestionType.MULTIPLE_CHOICE, text: "Where are you ...?", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206403949518315_Audio.mp3", options: ["Tom", "some", "from", "Come"], answer: "from", exp: "B·∫°n t·ª´ ƒë√¢u ƒë·∫øn.", hint: "T·ª´." },
        { id: 168, type: QuestionType.MULTIPLE_CHOICE, text: "They like ... .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206419380949920_Audio.mp3", options: ["playing", "swimming", "singing", "Speaking"], answer: "singing", exp: "H√°t h√≤.", hint: "H√°t." },
        { id: 169, type: QuestionType.REARRANGE, parts: ["twice", "a week.", "have", "Music", "I"], answer: "I have Music twice a week.", exp: "T·∫ßn su·∫•t h·ªçc.", hint: "I have..." },
        { id: 170, type: QuestionType.MULTIPLE_CHOICE, text: "do many ... .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206418611848843_Audio.mp3", options: ["sing", "think", "things", "Thank"], answer: "things", exp: "Do things: l√†m vi·ªác.", hint: "Vi·ªác." },
        { id: 171, type: QuestionType.REARRANGE, parts: ["of", "Nam‚Äôs school?", "is", "What", "the name"], answer: "What is the name of Nam‚Äôs school?", exp: "H·ªèi t√™n tr∆∞·ªùng.", hint: "What is..." },
        { id: 172, type: QuestionType.MULTIPLE_CHOICE, text: "Can you swim? ‚Äì Yes, I ... .", options: ["are", "am", "can", "can‚Äôt"], answer: "can", exp: "Yes, I can.", hint: "ƒê·ªìng √Ω." },
        { id: 173, type: QuestionType.MULTIPLE_CHOICE, text: "... do you like Music? ‚Äì Because I like to sing.", options: ["How", "When", "Why", "Who"], answer: "Why", exp: "Why... because.", hint: "T·∫°i sao." },
        { id: 174, type: QuestionType.MULTIPLE_CHOICE, text: "goes to the___.", img: "https://plus.unsplash.com/premium_vector-1729239907383-521490651d3c?w=400", options: ["cinema", "zoo", "amusement park", "Park"], answer: "zoo", exp: "V∆∞·ªùn b√°ch th√∫.", hint: "V∆∞·ªùn th√∫." },
        { id: 175, type: QuestionType.MULTIPLE_CHOICE, text: "Linda _______ swim.", options: ["is", "play", "can", "do"], answer: "can", exp: "Kh·∫£ nƒÉng.", hint: "C√≥ th·ªÉ." },
        { id: 176, type: QuestionType.REARRANGE, parts: ["Singapore.", "She", "from", "is"], answer: "She is from Singapore.", exp: "ƒê·∫øn t·ª´ Singapore.", hint: "She is..." },
        { id: 177, type: QuestionType.FILL_IN_BLANK, text: "fr_ _ Australia.", answer: "om", exp: "From.", hint: "T·ª´." },
        { id: 178, type: QuestionType.FILL_IN_BLANK, text: "What _ _ _ _?", answer: "time", exp: "H·ªèi gi·ªù.", hint: "M·∫•y gi·ªù." },
        { id: 179, type: QuestionType.MULTIPLE_CHOICE, text: "Odd one out:", options: ["badminton", "baseball", "playground", "basketball"], answer: "playground", exp: "ƒê·ªãa ƒëi·ªÉm.", hint: "Kh√°c lo·∫°i." },
        { id: 180, type: QuestionType.REARRANGE, parts: ["holiday", "last month.", "My aunt", "in Nha Trang", "went on"], answer: "My aunt went on holiday in Nha Trang last month.", exp: "Nha Trang.", hint: "My aunt..." },
        { id: 181, type: QuestionType.FILL_IN_BLANK, text: "w_ y.", answer: "a", exp: "Way: ƒë∆∞·ªùng.", hint: "ƒê∆∞·ªùng." },
        { id: 182, type: QuestionType.REARRANGE, parts: ["is your", "What", "favourite", "comic book?"], answer: "What is your favourite comic book?", exp: "Truy·ªán ∆∞a th√≠ch.", hint: "What is..." },
        { id: 183, type: QuestionType.REARRANGE, parts: ["She", "spell", "her name.", "doesn‚Äôt know", "how to"], answer: "She doesn‚Äôt know how to spell her name.", exp: "ƒê√°nh v·∫ßn t√™n.", hint: "She doesn't..." },
        { id: 184, type: QuestionType.FILL_IN_BLANK, text: "W_ _ _ _ was your mother?", answer: "here", exp: "Where.", hint: "·ªû ƒë√¢u." },
        { id: 185, type: QuestionType.REARRANGE, parts: ["four", "the room?", "in", "Are there", "chairs"], answer: "Are there four chairs in the room?", exp: "H·ªèi s·ªë l∆∞·ª£ng gh·∫ø.", hint: "Are there..." },
        { id: 186, type: QuestionType.MULTIPLE_CHOICE, text: "my ... .", options: ["ruler", "rulers", "a ruler", "the ruler"], answer: "rulers", exp: "Those are rulers.", hint: "Th∆∞·ªõc." },
        { id: 187, type: QuestionType.FILL_IN_BLANK, text: "Japan_ _ e.", answer: "es", exp: "Japanese.", hint: "Ng∆∞·ªùi Nh·∫≠t." },
        { id: 188, type: QuestionType.FILL_IN_BLANK, text: "hard-_ _ _ _ _ _ _ .", answer: "working", exp: "Hard-working.", hint: "ChƒÉm ch·ªâ." },
        { id: 189, type: QuestionType.FILL_IN_BLANK, text: "H_ _ _ y birthday.", answer: "app", exp: "Happy.", hint: "Vui v·∫ª." },
        { id: 190, type: QuestionType.MULTIPLE_CHOICE, text: "They like ... .", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206431247676534_Audio.mp3", options: ["playing", "swimming", "singing", "Speaking"], answer: "singing", exp: "H√°t.", hint: "H√°t." },
        { id: 191, type: QuestionType.FILL_IN_BLANK, text: "ha_ e.", answer: "v", exp: "Have.", hint: "C√≥." },
        { id: 192, type: QuestionType.REARRANGE, parts: ["classmate.", "a", "I", "have", "new"], answer: "I have a new classmate.", exp: "B·∫°n m·ªõi.", hint: "I have..." },
        { id: 193, type: QuestionType.MULTIPLE_CHOICE, text: "Can I ... your name?", options: ["do", "have", "does", "has"], answer: "have", exp: "Can I have...", hint: "Bi·∫øt." },
        { id: 194, type: QuestionType.FILL_IN_BLANK, text: "C_ _ you?", answer: "an", exp: "Can.", hint: "C√≥ th·ªÉ." },
        { id: 195, type: QuestionType.MULTIPLE_CHOICE, text: "Where are you ...?", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206442193321320_Audio.mp3", options: ["Tom", "some", "from", "Come"], answer: "from", exp: "From.", hint: "T·ª´." },
        { id: 196, type: QuestionType.MULTIPLE_CHOICE, text: "on the ___ of March.", img: "https://media.istockphoto.com/id/1829960849/vector/march-26-daily-calendar-icon-in-flat-design-style-on-blank-background.webp?a=1&b=1&s=612x612&w=0&k=20&c=Bma7z9PDy7DaWkvK3iwfrcO0PyJ5YZPsG9pqxD58YZE=", options: ["twenty-sixth", "twenty-eighth", "twenty-six", "twentieth-six"], answer: "twenty-sixth", exp: "Ng√†y 26.", hint: "26." },
        { id: 197, type: QuestionType.REARRANGE, parts: ["milk?", "some", "like", "you", "Would"], answer: "Would you like some milk?", exp: "L·ªùi m·ªùi.", hint: "Would you..." },
        { id: 198, type: QuestionType.FILL_IN_BLANK, text: "_ _ _ _ urite subject.", answer: "favo", exp: "Favourite.", hint: "∆Øa th√≠ch." },
        { id: 199, type: QuestionType.MULTIPLE_CHOICE, text: "Listen and tick:", audio: "https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/21/635206409407725957_Audio.mp3", options: ["He can speak English.", "He can‚Äôt speak English.", "She can speak English.", "She can‚Äôt speak English."], answer: "He can speak English.", exp: "N√≥i Ti·∫øng Anh.", hint: "C√≥ th·ªÉ." },
        { id: 200, type: QuestionType.FILL_IN_BLANK, text: "This gift is _ _ r you.", answer: "fo", exp: "For you.", hint: "Cho." }
      ];

      const FINAL_DATA = RAW_QUESTIONS;

      const shuffle = (array) => {
        const arr = [...array];
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
      };

      // --- COMPONENTS ---
      const Button = ({ children, variant = 'primary', className = '', ...props }) => {
        const variants = {
          primary: "bg-indigo-600 text-white shadow-indigo-100 hover:bg-indigo-700",
          secondary: "bg-emerald-500 text-white shadow-emerald-100 hover:bg-emerald-600",
          danger: "bg-rose-500 text-white shadow-rose-100 hover:bg-rose-600",
          outline: "bg-white border-2 border-slate-200 text-slate-600 hover:border-indigo-500 hover:text-indigo-600"
        };
        return (
          <button className={`px-6 py-3 rounded-2xl font-bold transition-all btn-pop shadow-md flex items-center justify-center gap-2 disabled:opacity-50 ${variants[variant]} ${className}`} {...props}>
            {children}
          </button>
        );
      };

      const QuestionContent = ({ question, onAnswer, isAnswered, userAnswer }) => {
        const [fibInput, setFibInput] = useState('');
        const [reParts, setReParts] = useState([]);
        const [showHint, setShowHint] = useState(false);

        const jumbledParts = useMemo(() => {
          if (question.type === QuestionType.REARRANGE && question.parts) {
            return shuffle(question.parts);
          }
          return [];
        }, [question.id]);

        useEffect(() => {
          setFibInput('');
          setReParts([]);
          setShowHint(false);
        }, [question.id]);

        const isCorrect = userAnswer && normalize(userAnswer) === normalize(question.answer);

        const checkAnswer = () => {
          if (question.type === QuestionType.REARRANGE) onAnswer(reParts.join(' '));
          else onAnswer(fibInput.trim());
        };

        const handleKeyDown = (e) => {
          if (e.key === 'Enter' && !isAnswered) {
            if (question.type === QuestionType.FILL_IN_BLANK && fibInput.trim()) checkAnswer();
            if (question.type === QuestionType.REARRANGE && reParts.length > 0) checkAnswer();
          }
        };

        const toggleRePart = (p) => {
          if (isAnswered) return;
          if (reParts.includes(p)) setReParts(reParts.filter(x => x !== p));
          else setReParts([...reParts, p]);
        };

        return (
          <div className="w-full max-w-2xl mx-auto question-card-enter" onKeyDown={handleKeyDown} tabIndex="0">
            <div className="bg-white rounded-[2.5rem] shadow-2xl p-6 sm:p-10 border border-slate-100 outline-none">
              <div className="flex justify-between items-center mb-6">
                <span className="bg-slate-100 text-slate-500 px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest">
                  {question.type === 'MC' ? 'Tr·∫Øc nghi·ªám' : question.type === 'FIB' ? 'ƒêi·ªÅn t·ª´' : 'S·∫Øp x·∫øp'}
                </span>
                <button 
                  onClick={() => setShowHint(!showHint)} 
                  className={`text-[10px] font-bold px-3 py-1 rounded-lg border transition-all ${showHint ? 'bg-amber-500 text-white border-amber-600' : 'text-amber-600 bg-amber-50 border-amber-100'}`}
                >
                  {showHint ? '·∫®N G·ª¢I √ù' : 'G·ª¢I √ù üí°'}
                </button>
              </div>

              {question.img && <img src={question.img} className="w-full h-48 object-cover rounded-3xl mb-6 shadow-md border border-slate-100" alt="minh h·ªça" />}
              
              {question.audio && (
                <div className="mb-6 flex justify-center">
                  <button onClick={() => new Audio(question.audio).play()} className="p-4 bg-indigo-600 text-white rounded-2xl flex items-center gap-3 shadow-lg btn-pop">
                    <span className="text-2xl">üîä</span> <span className="font-bold">B·∫•m ƒë·ªÉ nghe</span>
                  </button>
                </div>
              )}

              {showHint && !isAnswered && (
                <div className="mb-6 p-5 bg-amber-50 border-l-8 border-amber-400 rounded-2xl text-amber-900 font-bold text-base shadow-sm animate-slide-up">
                  <div className="flex items-center gap-2 mb-1">
                    <span className="text-xl">üí°</span> <span className="text-xs uppercase font-black opacity-60">G·ª£i √Ω chi ti·∫øt:</span>
                  </div>
                  {question.hint || `ƒê√°p √°n c√≥ ${question.answer.length} k√Ω t·ª±.`}
                </div>
              )}

              <h2 className="text-3xl font-nunito font-black text-slate-800 mb-8 leading-tight text-center">
                {question.text || 'S·∫Øp x·∫øp c√°c t·ª´ sau th√†nh c√¢u ƒë√∫ng:'}
              </h2>

              {question.type === QuestionType.MULTIPLE_CHOICE && (
                <div className="grid grid-cols-1 gap-3">
                  {question.options.map((opt, i) => {
                    const isSelected = userAnswer === opt;
                    const isCorr = normalize(opt) === normalize(question.answer);
                    let cls = "bg-slate-50 border-slate-100 hover:border-indigo-300";
                    if (isAnswered) {
                        if (isCorr) cls = "bg-emerald-50 border-emerald-500 text-emerald-900 ring-4 ring-emerald-100";
                        else if (isSelected) cls = "bg-rose-50 border-rose-500 text-rose-900 ring-4 ring-rose-100";
                        else cls = "opacity-40 border-slate-100 grayscale pointer-events-none";
                    }
                    return (
                      <button key={i} onClick={() => !isAnswered && onAnswer(opt)} disabled={isAnswered} className={`w-full p-5 rounded-2xl text-left border-2 transition-all flex items-center gap-4 ${cls}`}>
                        <span className={`w-10 h-10 shrink-0 rounded-xl flex items-center justify-center text-lg font-black ${isAnswered && isCorr ? 'bg-emerald-500 text-white' : 'bg-white text-slate-400 shadow-sm'}`}>
                          {String.fromCharCode(65+i)}
                        </span>
                        <span className="text-xl font-bold">{opt}</span>
                      </button>
                    );
                  })}
                </div>
              )}

              {question.type === QuestionType.FILL_IN_BLANK && (
                <div className="space-y-6">
                  <input 
                    type="text" 
                    placeholder="Nh·∫≠p ƒë√°p √°n..." 
                    value={isAnswered ? userAnswer : fibInput} 
                    onChange={e => setFibInput(e.target.value)} 
                    onKeyDown={handleKeyDown}
                    disabled={isAnswered} 
                    autoFocus
                    className={`w-full p-6 rounded-3xl border-4 text-3xl font-black text-center outline-none transition-all ${isAnswered ? (isCorrect ? 'border-emerald-500 bg-emerald-50 text-emerald-800' : 'border-rose-500 bg-rose-50 text-rose-800') : 'border-slate-100 bg-slate-50 focus:border-indigo-500 focus:bg-white focus:ring-8 focus:ring-indigo-100'}`} 
                  />
                  {!isAnswered && <Button onClick={checkAnswer} className="w-full !py-5 text-xl" disabled={!fibInput.trim()}>X√ÅC NH·∫¨N (ENTER)</Button>}
                </div>
              )}

              {question.type === QuestionType.REARRANGE && (
                <div className="space-y-6">
                  <div className="flex flex-wrap gap-2.5 p-5 bg-slate-50 rounded-2xl border border-slate-200 min-h-[100px] justify-center items-center shadow-inner">
                    {jumbledParts.map((p, i) => (
                      <button key={i} onClick={() => toggleRePart(p)} disabled={isAnswered || reParts.includes(p)} className={`px-5 py-3 rounded-xl bg-white border-2 border-slate-200 font-black text-lg shadow-sm transition-all active:scale-90 ${reParts.includes(p) ? 'opacity-20 scale-95' : 'hover:border-indigo-400 hover:text-indigo-600'}`}>{p}</button>
                    ))}
                  </div>
                  <div className={`min-h-[120px] p-6 rounded-[2rem] border-4 border-dashed flex flex-wrap gap-3 justify-center items-center transition-all ${isAnswered ? (isCorrect ? 'border-emerald-500 bg-emerald-50' : 'border-rose-500 bg-rose-50') : 'border-slate-200 bg-white'}`}>
                    {reParts.length === 0 && !isAnswered && <span className="text-slate-300 font-bold italic">B·∫•m ch·ªçn c√°c t·ª´ v·ª±ng ph√≠a tr√™n...</span>}
                    {reParts.map((p, i) => (
                      <button key={i} onClick={() => toggleRePart(p)} disabled={isAnswered} className="bg-indigo-600 text-white px-5 py-3 rounded-xl font-black text-lg shadow-lg animate-slide-up">{p}</button>
                    ))}
                  </div>
                  {!isAnswered && (
                    <div className="flex gap-4">
                      <Button variant="outline" onClick={() => setReParts([])} className="flex-1 !rounded-2xl">L√ÄM L·∫†I</Button>
                      <Button onClick={checkAnswer} className="flex-[2] !py-5 text-xl !rounded-2xl" disabled={reParts.length === 0}>X√ÅC NH·∫¨N (ENTER)</Button>
                    </div>
                  )}
                </div>
              )}

              {isAnswered && (
                <div className={`mt-8 p-6 rounded-3xl border-l-[12px] shadow-lg animate-slide-in ${isCorrect ? 'bg-emerald-50 border-emerald-500' : 'bg-rose-50 border-rose-500'}`}>
                  <div className="flex items-start gap-5">
                    <div className={`w-14 h-14 rounded-2xl flex items-center justify-center text-white text-3xl font-black shadow-md ${isCorrect ? 'bg-emerald-500' : 'bg-rose-500'}`}>
                      {isCorrect ? '‚úì' : '‚úï'}
                    </div>
                    <div className="flex-1">
                      <h3 className={`text-2xl font-black mb-2 ${isCorrect ? 'text-emerald-800' : 'text-rose-800'}`}>{isCorrect ? 'CH√çNH X√ÅC!' : 'SAI M·∫§T R·ªíI!'}</h3>
                      {!isCorrect && (
                        <div className="mb-3 p-3 bg-white/80 rounded-xl border border-rose-100">
                           <p className="text-[10px] font-black text-rose-400 uppercase tracking-widest mb-1">ƒê√°p √°n ƒë√∫ng l√†:</p>
                           <p className="text-xl font-black text-slate-800 leading-tight">{question.answer}</p>
                        </div>
                      )}
                      <p className="text-slate-700 font-bold leading-relaxed">
                        <span className="text-indigo-600 text-xs font-black mr-2 uppercase bg-indigo-50 px-2 py-0.5 rounded">Gi·∫£i th√≠ch:</span>
                        {question.exp}
                      </p>
                    </div>
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      };

      const StartScreen = ({ onStart }) => {
        const [name, setName] = useState(localStorage.getItem('ioe_name') || '');
        return (
          <div className="min-h-screen flex items-center justify-center bg-indigo-600 p-6 relative overflow-hidden">
            <div className="bg-white rounded-[3.5rem] shadow-2xl p-10 sm:p-16 max-w-xl w-full text-center relative z-10 border-8 border-white">
              <span className="text-8xl mb-8 block animate-float">üéì</span>
              <h1 className="text-5xl font-nunito font-black text-slate-800 mb-2 tracking-tighter">IOE L·ªöP 4</h1>
              <p className="text-slate-400 font-black uppercase tracking-widest text-sm mb-12">B·ªò ƒê·ªÄ √îN T·∫¨P S·ªê 09 - 200 C√ÇU</p>
              <form onSubmit={e => { e.preventDefault(); name.trim() && onStart(name); }} className="space-y-6 text-left">
                <label className="text-xs font-black text-slate-400 uppercase tracking-widest ml-4">T√™n ng∆∞·ªùi ch∆°i:</label>
                <input type="text" value={name} onChange={e => setName(e.target.value)} placeholder="NH·∫¨P T√äN C·ª¶A B·∫†N" required className="w-full px-8 py-6 rounded-3xl border-4 border-slate-100 text-2xl font-black text-center outline-none focus:border-indigo-500 transition-all uppercase shadow-inner" />
                <Button type="submit" className="w-full !py-7 text-2xl !rounded-[2rem] shadow-xl">V√ÄO THI NGAY</Button>
              </form>
            </div>
          </div>
        );
      };

      const ResultScreen = ({ userName, userAnswers, score, onRetryAll, onRetryWrong }) => {
        const [showReview, setShowReview] = useState(false);
        const correctCount = userAnswers.filter(a => a.isCorr).length;
        const total = userAnswers.length;
        const percent = total > 0 ? Math.round((correctCount / total) * 100) : 0;
        const wrongOnes = userAnswers.filter(a => !a.isCorr);

        useEffect(() => {
          if (percent > 70) confetti({ particleCount: 200, spread: 90, origin: { y: 0.6 } });
        }, []);

        return (
          <div className="min-h-screen bg-slate-50 flex flex-col items-center justify-center p-6 py-12">
            <div className="bg-white rounded-[4rem] p-10 sm:p-16 shadow-2xl text-center max-w-3xl w-full border-4 border-white animate-slide-in">
              <span className="text-8xl mb-8 block"> {percent > 85 ? 'üåü' : percent > 50 ? 'üçÄ' : 'üí™'} </span>
              <h2 className="text-5xl font-nunito font-black text-slate-800 mb-2 uppercase">K·∫æT QU·∫¢</h2>
              <p className="text-slate-400 font-bold uppercase tracking-widest text-sm mb-10">Ng∆∞·ªùi ch∆°i: <span className="text-indigo-600">{userName}</span></p>
              
              <div className="grid grid-cols-2 gap-6 mb-12">
                <div className="bg-indigo-50 p-10 rounded-[3rem] border border-indigo-100 flex flex-col items-center shadow-sm">
                    <p className="text-5xl font-black text-indigo-600">{score}</p>
                    <p className="text-[11px] font-black text-indigo-400 uppercase tracking-widest mt-2">T·ªïng ƒêi·ªÉm</p>
                </div>
                <div className="bg-emerald-50 p-10 rounded-[3rem] border border-emerald-100 flex flex-col items-center shadow-sm">
                    <p className="text-5xl font-black text-emerald-600">{percent}%</p>
                    <p className="text-[11px] font-black text-emerald-400 uppercase tracking-widest mt-2">ƒê·ªô ch√≠nh x√°c</p>
                </div>
              </div>

              <div className="flex flex-col sm:flex-row gap-4 mb-10">
                <Button onClick={onRetryAll} className="flex-1 !py-6 text-xl !rounded-[2rem]">CH∆†I L·∫†I T·ª™ ƒê·∫¶U</Button>
                {wrongOnes.length > 0 && (
                  <Button onClick={onRetryWrong} variant="danger" className="flex-1 !py-6 text-xl !rounded-[2rem]">L√ÄM L·∫†I C√ÇU SAI</Button>
                )}
                <Button onClick={() => setShowReview(!showReview)} variant="outline" className="flex-1 !py-6 text-xl !rounded-[2rem]">
                  {showReview ? 'ƒê√ìNG XEM L·∫†I' : '√îN T·∫¨P C√ÇU SAI'}
                </Button>
              </div>

              {showReview && (
                <div className="text-left space-y-5 max-h-[500px] overflow-y-auto pr-3 custom-scrollbar border-t-2 pt-8">
                  <h3 className="text-2xl font-black text-slate-800 uppercase mb-6 flex items-center gap-3">
                    <span className="w-10 h-10 bg-rose-500 text-white rounded-xl flex items-center justify-center text-sm">!</span> 
                    Danh s√°ch c√¢u sai ({wrongOnes.length} c√¢u):
                  </h3>
                  {wrongOnes.map((ans, idx) => {
                    const q = RAW_QUESTIONS.find(x => x.id === ans.qId);
                    return q ? (
                      <div key={idx} className="bg-white p-6 rounded-3xl border-2 border-slate-100 hover:border-indigo-200 transition-all shadow-sm">
                        <span className="text-[10px] font-black px-3 py-1 bg-slate-100 text-slate-500 rounded-lg uppercase">C√¢u {q.id}</span>
                        <p className="font-black text-slate-800 mb-4 text-xl leading-snug mt-2">{q.text || 'S·∫Øp x·∫øp c√¢u: ' + q.answer}</p>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm mb-4">
                          <div className="p-4 bg-rose-50 rounded-2xl border border-rose-100">
                            <p className="text-[10px] font-bold text-rose-400 uppercase tracking-wider mb-1">B·∫°n tr·∫£ l·ªùi:</p>
                            <p className="font-black text-rose-900 text-lg">{ans.resp || "(B·ªè tr·ªëng)"}</p>
                          </div>
                          <div className="p-4 bg-emerald-50 rounded-2xl border border-emerald-100">
                            <p className="text-[10px] font-bold text-emerald-400 uppercase tracking-wider mb-1">ƒê√°p √°n ƒë√∫ng:</p>
                            <p className="font-black text-emerald-900 text-lg">{q.answer}</p>
                          </div>
                        </div>
                      </div>
                    ) : null;
                  })}
                </div>
              )}
            </div>
          </div>
        );
      };

      const App = () => {
        const [gameState, setGameState] = useState(GameState.START);
        const [userName, setUserName] = useState('');
        const [activeQuestions, setActiveQuestions] = useState(FINAL_DATA);
        const [currentIndex, setCurrentIndex] = useState(0);
        const [userAnswers, setUserAnswers] = useState([]);
        const [score, setScore] = useState(0);
        const [timeLeft, setTimeLeft] = useState(TOTAL_TIME);
        const [showList, setShowList] = useState(false);

        useEffect(() => {
          let timer;
          if (gameState === GameState.PLAYING && timeLeft > 0) {
            timer = setInterval(() => setTimeLeft(p => p - 1), 1000);
          } else if (timeLeft === 0 && gameState === GameState.PLAYING) setGameState(GameState.FINISHED);
          return () => clearInterval(timer);
        }, [gameState, timeLeft]);

        const handleAnswer = (resp) => {
          const q = activeQuestions[currentIndex];
          const isCorr = normalize(resp) === normalize(q.answer);
          
          if (isCorr) setScore(s => s + POINTS_PER_CORRECT);
          setUserAnswers(prev => [...prev.filter(a => a.qId !== q.id), { qId: q.id, resp, isCorr }]);
        };

        const handleRetryWrong = () => {
          const wrongIds = userAnswers.filter(a => !a.isCorr).map(a => a.qId);
          const wrongQuests = RAW_QUESTIONS.filter(q => wrongIds.includes(q.id));
          setActiveQuestions(wrongQuests);
          setCurrentIndex(0);
          setUserAnswers([]);
          setScore(0);
          setTimeLeft(TOTAL_TIME);
          setGameState(GameState.PLAYING);
        };

        const handleRetryAll = () => {
          setActiveQuestions(FINAL_DATA);
          setCurrentIndex(0);
          setUserAnswers([]);
          setScore(0);
          setTimeLeft(TOTAL_TIME);
          setGameState(GameState.PLAYING);
        };

        const onJump = (idx) => { setCurrentIndex(idx); setShowList(false); };

        if (gameState === GameState.START) return <StartScreen onStart={n => { setUserName(n); setGameState(GameState.PLAYING); localStorage.setItem('ioe_name', n); }} />;

        if (gameState === GameState.FINISHED) {
            return <ResultScreen 
              userName={userName} 
              userAnswers={userAnswers} 
              score={score}
              onRetryAll={handleRetryAll}
              onRetryWrong={handleRetryWrong}
            />;
        }

        const currentQ = activeQuestions[currentIndex];
        const answer = userAnswers.find(a => a.qId === currentQ.id);
        const progress = ((currentIndex + 1) / activeQuestions.length) * 100;

        return (
          <div className="min-h-screen bg-slate-50 flex flex-col p-4 pb-32">
            <div className="w-full max-w-4xl mx-auto mb-6">
              <div className="glass rounded-[2rem] p-4 flex flex-wrap items-center justify-between gap-4 shadow-xl border-4 border-white">
                <div className="flex items-center gap-3">
                  <div className="w-12 h-12 rounded-2xl bg-indigo-600 flex items-center justify-center text-white font-black text-xl shadow-lg">
                    {userName[0]?.toUpperCase() || 'U'}
                  </div>
                  <div className="hidden sm:block">
                    <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none">Ng∆∞·ªùi ch∆°i</p>
                    <p className="text-lg font-black text-slate-800 truncate max-w-[120px]">{userName}</p>
                  </div>
                </div>
                <div className="flex items-center gap-8">
                  <div className="text-center">
                    <p className="text-[10px] font-black text-slate-400 uppercase leading-none">Th·ªùi gian</p>
                    <p className={`text-2xl font-black ${timeLeft < 60 ? 'text-danger animate-pulse' : 'text-slate-800'}`}>
                      {Math.floor(timeLeft / 60)}:{(timeLeft % 60).toString().padStart(2, '0')}
                    </p>
                  </div>
                  <div className="text-center">
                    <p className="text-[10px] font-black text-slate-400 uppercase leading-none">ƒêi·ªÉm</p>
                    <p className="text-2xl font-black text-indigo-600">{score}</p>
                  </div>
                </div>
                <Button variant="outline" className="!px-5 !py-3 !rounded-2xl text-xs !border-slate-100 shadow-sm" onClick={() => setShowList(true)}>üìã DANH S√ÅCH</Button>
              </div>
              <div className="mt-5 px-3">
                <div className="w-full h-3 bg-slate-200 rounded-full overflow-hidden shadow-inner">
                  <div className="h-full bg-gradient-to-r from-indigo-500 to-indigo-700 transition-all duration-700 ease-out" style={{ width: `${progress}%` }}></div>
                </div>
              </div>
            </div>

            <QuestionContent question={currentQ} onAnswer={handleAnswer} isAnswered={!!answer} userAnswer={answer?.resp} />
            
            <div className="fixed bottom-0 left-0 right-0 p-8 bg-white/80 backdrop-blur-xl border-t border-slate-200 z-50 flex justify-center shadow-2xl">
              <div className="w-full max-w-2xl flex gap-4 items-center">
                <Button variant="outline" onClick={() => setCurrentIndex(Math.max(0, currentIndex - 1))} disabled={currentIndex === 0} className="!p-5 !rounded-2xl shrink-0 border-2">‚Üê</Button>
                <div className="flex-1">
                  {answer ? (
                    <Button onClick={() => currentIndex === activeQuestions.length - 1 ? setGameState(GameState.FINISHED) : setCurrentIndex(currentIndex + 1)} className="w-full !py-5 text-2xl !rounded-2xl shadow-indigo-200" variant="secondary">
                        {currentIndex === activeQuestions.length - 1 ? 'XEM K·∫æT QU·∫¢ üèÅ' : 'C√ÇU TI·∫æP THEO ‚Üí'}
                    </Button>
                  ) : (
                    <Button onClick={() => setCurrentIndex(Math.min(activeQuestions.length - 1, currentIndex + 1))} variant="outline" className="w-full !py-5 !rounded-2xl font-black text-slate-300 border-dashed hover:border-indigo-400 hover:text-indigo-400">B·ªé QUA C√ÇU N√ÄY</Button>
                  )}
                </div>
                <Button variant="outline" onClick={() => setCurrentIndex(Math.min(activeQuestions.length - 1, currentIndex + 1))} disabled={currentIndex === activeQuestions.length - 1 || !answer} className="!p-5 !rounded-2xl shrink-0 border-2">‚Üí</Button>
              </div>
            </div>

            {showList && (
              <div className="fixed inset-0 z-[100] bg-slate-900/70 backdrop-blur-md flex items-center justify-center p-4">
                <div className="bg-white rounded-[3rem] shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col overflow-hidden animate-slide-up border-8 border-white">
                    <div className="p-8 border-b flex justify-between items-center bg-slate-50">
                        <div>
                           <h2 className="text-3xl font-black text-slate-800 uppercase tracking-tighter">DANH S√ÅCH C√ÇU H·ªéI</h2>
                           <p className="text-xs font-bold text-slate-400 uppercase tracking-widest">{activeQuestions.length} C√ÇU TRONG L∆Ø·ª¢T THI N√ÄY</p>
                        </div>
                        <button onClick={() => setShowList(false)} className="w-12 h-12 flex items-center justify-center text-3xl font-black text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-2xl transition-all">‚úï</button>
                    </div>
                    <div className="flex-1 overflow-y-auto p-8 grid grid-cols-5 sm:grid-cols-10 gap-3 custom-scrollbar bg-white shadow-inner">
                        {activeQuestions.map((q, i) => {
                            const ans = userAnswers.find(a => a.qId === q.id);
                            let cls = "bg-slate-50 text-slate-300 border-slate-100 hover:border-indigo-200";
                            if (i === currentIndex) cls = "ring-4 ring-indigo-500 bg-white text-indigo-600 border-indigo-500 scale-110 z-10";
                            else if (ans) cls = ans.isCorr ? "bg-emerald-500 text-white border-emerald-600" : "bg-rose-500 text-white border-rose-600";
                            return <button key={i} onClick={() => onJump(i)} className={`h-14 rounded-2xl font-black text-lg border-2 transition-all transform active:scale-95 ${cls}`}>{q.id}</button>
                        })}
                    </div>
                </div>
              </div>
            )}
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
</body>
</html>
